/*! @copyright Apollo GraphQL | @license MIT | @link apollographql.com | @version 1.5.14 *//* eslint-disable */import{__rest as e,__assign as r,__extends as n}from"./tslib.js";import{ApolloLink as t,fromError as o,Observable as i}from"./apollo-link.js";import{checkFetcher as a,selectURI as s,selectHttpOptionsAndBody as u,fallbackHttpConfig as l,createSignalIfSupported as c,serializeFetchParameter as p,parseAndCheckHttpResponse as f}from"./apollo-link-http-common.js";var h=function(n){void 0===n&&(n={});var h=n.uri,d=void 0===h?"/graphql":h,v=n.fetch,m=n.includeExtensions,x=n.useGETForQueries,E=e(n,["uri","fetch","includeExtensions","useGETForQueries"]);a(v),v||(v=fetch);var b={http:{includeExtensions:m},options:E.fetchOptions,credentials:E.credentials,headers:E.headers};return new t(function(e){var n=s(e,d),t=e.getContext(),a={};if(t.clientAwareness){var h=t.clientAwareness,m=h.name,E=h.version;m&&(a["apollographql-client-name"]=m),E&&(a["apollographql-client-version"]=E)}var y,q=r({},a,t.headers),g={http:t.http,options:t.fetchOptions,credentials:t.credentials,headers:q},w=u(e,l,b,g),O=w.options,G=w.body;if(!O.signal){var T=c(),k=T.controller,A=T.signal;(y=k)&&(O.signal=A)}if(x&&!e.query.definitions.some(function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})&&(O.method="GET"),"GET"===O.method){var C=function(e,r){var n=[],t=function(e,r){n.push(e+"="+encodeURIComponent(r))};"query"in r&&t("query",r.query);r.operationName&&t("operationName",r.operationName);if(r.variables){var o=void 0;try{o=p(r.variables,"Variables map")}catch(e){return{parseError:e}}t("variables",o)}if(r.extensions){var i=void 0;try{i=p(r.extensions,"Extensions map")}catch(e){return{parseError:e}}t("extensions",i)}var a="",s=e,u=e.indexOf("#");-1!==u&&(a=e.substr(u),s=e.substr(0,u));var l=-1===s.indexOf("?")?"?":"&";return{newURI:s+l+n.join("&")+a}}(n,G),I=C.newURI,N=C.parseError;if(N)return o(N);n=I}else try{O.body=p(G,"Payload")}catch(N){return o(N)}return new i(function(r){return v(n,O).then(function(r){return e.setContext({response:r}),r}).then(f(e)).then(function(e){return r.next(e),r.complete(),e}).catch(function(e){"AbortError"!==e.name&&(e.result&&e.result.errors&&e.result.data&&r.next(e.result),r.error(e))}),function(){y&&y.abort()}})})};var d=function(e){function r(r){return e.call(this,h(r).request)||this}return n(r,e),r}(t);export{h as createHttpLink,d as HttpLink};