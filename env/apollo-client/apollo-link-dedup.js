/*! @copyright Apollo GraphQL | @license MIT | @link apollographql.com | @version 1.0.18 *//* eslint-disable */import{__extends as e}from"./tslib.js";import{Observable as r,ApolloLink as s}from"./apollo-link.js";var t=function(s){function t(){var e=null!==s&&s.apply(this,arguments)||this;return e.inFlightRequestObservables=new Map,e.subscribers=new Map,e}return e(t,s),t.prototype.request=function(e,s){var t=this;if(e.getContext().forceFetch)return s(e);var i=e.toKey();if(!this.inFlightRequestObservables.get(i)){var n,b=s(e),u=new r(function(e){return t.subscribers.has(i)||t.subscribers.set(i,new Set),t.subscribers.get(i).add(e),n||(n=b.subscribe({next:function(e){var r=t.subscribers.get(i);t.subscribers.delete(i),t.inFlightRequestObservables.delete(i),r&&(r.forEach(function(r){return r.next(e)}),r.forEach(function(e){return e.complete()}))},error:function(e){var r=t.subscribers.get(i);t.subscribers.delete(i),t.inFlightRequestObservables.delete(i),r&&r.forEach(function(r){return r.error(e)})}})),function(){t.subscribers.has(i)&&(t.subscribers.get(i).delete(e),0===t.subscribers.get(i).size&&(t.inFlightRequestObservables.delete(i),n&&n.unsubscribe()))}});this.inFlightRequestObservables.set(i,u)}return this.inFlightRequestObservables.get(i)},t}(s);export{t as DedupLink};